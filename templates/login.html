{% extends "base.html" %}
{% block title %}Sign in Â· FastWatermarker{% endblock %}

{% block content %}
<div class="d-flex align-items-center justify-content-center">
  <a href="/" class="text-decoration-none">
    <img
      class="brand-logo"
      src="{{ url_for('static', path='images/logo.png') }}"
      alt="Fast Watermarker"
      style="max-width: 225px; height: auto;"
      loading="eager" decoding="async"
    />
  </a>
</div>

<div class="container py-2">
  <div class="row justify-content-center">
    <div class="col-md-5">
      <div id="clerk-sign-in"></div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  // Use pageshow so it fires even from bfcache (back/forward)
  window.addEventListener('pageshow', async () => {
    if (!window.Clerk) return;
    try {
      await window.Clerk.load();

      const target = document.getElementById('clerk-sign-in');
      if (!target) return;

      // Avoid duplicate mounts on bfcache restores
      target.innerHTML = '';

      window.Clerk.mountSignIn(target, {
        redirectUrl: '/',
        // afterSignUpUrl: '/',
      });
    } catch (e) {
      console.error('Failed to mount SignIn:', e);
    }
  });
</script>
{% endblock %}